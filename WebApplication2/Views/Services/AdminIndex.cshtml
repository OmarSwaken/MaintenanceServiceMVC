@model IEnumerable<MaintenanceServiceMVC.Models.Service>

 @{
    ViewData["Title"] = "Manage Services";
}

<h2>Manage Services</h2>

<div id="service-table">
    <partial name="_ServiceTable" model="Model" />
</div>

<div class="mb-3">
    <a asp-action="Create" class="btn btn-success">+ Add New Service</a>
</div>


@section Scripts {
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const tableDiv = document.getElementById("service-table");

            tableDiv.addEventListener("click", function (e) {
                if (!e.target.classList.contains("delete-btn")) return;

                const id = e.target.getAttribute("data-id");
                if (!confirm("Are you sure you want to delete this service?")) return;

                fetch('@Url.Action("Delete", "Services")', {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/x-www-form-urlencoded",
                        "RequestVerificationToken": document.querySelector('input[name="__RequestVerificationToken"]').value
                    },
                    body: `id=${id}`
                })
                .then(res => res.text())
                .then(html => {
                    tableDiv.innerHTML = html;
                });
            });
        });
    </script>
}
